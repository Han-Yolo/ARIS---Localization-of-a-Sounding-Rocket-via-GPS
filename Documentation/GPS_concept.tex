\chapter{GPS Concept and Error Sources}\label{ch:GPS_concept}

Along with earlier navigation systems, this chapter explains the positioning concept of GPS and modern Global Navigation Satellite Systems in general.
The error sources that impact the accuracy of GPS are listed and split into categories that determine in which segment those errors occur.


\section{Predecessors}
Before there was GPS, other radionavigation systems were used.
They were mostly ground based and limited to a certan area or time.

One of the early examples is the U.S. system \textit{Loran}.
It works with multiple transmission stations with a distance of about 1000km to each other.
They send out pulse signals in all directions.
With the difference in time-of-arrival of those pulses, a receiver can triangulate its position.
This method is one variant of hyperbolic positioning.
Only a 2D fix can be acieved with such systems.
The height, if needed, has so be determined with a different method.
The development of \textit{Loran-A} was started during World War \rom{2}.
\textit{Loran-C} is the latest version and still in use today
It has a rms positioning accuracy of about 250m.

Another hyperpolic positioning system was \textit{Omega}.
It was the first global radionavigation system and operational from 1970 to 1997.
But rather than measuring the time differene of pulses, the phase difference of sinusoidal signals was measured.
This method resulted in a rms postitoning accuracy of 2-4km.
The lower accuracy can be explained with the much wider area it had to cover.

Apart from those ground based systems, there was a working satellite navigation system that came even before \textit{Omega}.
It is called \textit{Transit} and was operational from 1964 to 1996.
A doppler based systen that was launched by the U.S. Navy.
In doppler positioning, a 2D position can be determined from the time the doppler of the satellite signal changes from high to low and the sharpnes of the change.
At the moment the doppler changes, the satellite is the closest to the receiver on its orbit.
The distance from the projected orbit can then be determined by how sharp the doppler changes.
When the receiver is directly on the projected orbit, the doppler changes the fastest.
In contrast to modern GNSS, \textit{Transit} satellites had polar orbits with a low altitude of 1100km.
Only one satellite was visible at a time with a wait time of up to 100 minutes between them.
This made positioning a relatively long process, but the rms positioning accuracy was much better with 25m.

A range of counterparts from Russia and Eurpoe existed to those U.S. systems.
\textit{Gee} was a hyperbolic system from Great Britain similar to Loran.
It was used by the Royal Air Force during World War \rom{2}.
Doppler positioning was already used in reverse to determine the orbit of \textit{Sputnik \rom{1}} from a ground station with a known location.
The idea to measure the postiton on earth came from this application.
The Soviet Union had two dopple based system similar to \textit{Transit} called \textit{Parus} and \textit{Tsikada}. \cite{misra2011global}


\section{Global Navigation Satellite Systems}

From the knowledege gained from \textit{Tansit}, a new class of space based navigation systems emerged. 
The first one beeing the NAVSTAR Global Positioning System (GPS) developed by the U.S. Government.
The first GPS satellite was launched in 1978 and the system became fully operantional in 1993.
To be independent from the U.S. when it comes to navigation and improve local positioning, other nations started to launch their own systems.
The generic term for such systems is Global Navigation Satellite Systems (GNSS).
The fisrt addition to the group was the former Soviet and now Russian system GLONASS.
It is very similar to GPS in terms of use case and architecture.
Both were mainly developed for military use and designed to cover the whole globe with a full constellation of 24 satellites in medium earth orbit. \cite{misra2011global}

A newer addition is the european system GALILEO.
It is similar in terms of system architecture to GPS and GLONASS, but it is the first GNSS that is under civilian controll.
This guarantees that civil receivers can get the highest precission possible.
The GALILEO constellation is not yet complete with 14 usable satellites at the moment, but it is said to improve the accuracy to the centimeter level in normal operation. \cite{GSA_Galileo}

Beside global navigation systems, there are also local programs which improve the regional accuracy.
They consist of satellites in geostationary or geosynchronous orbits.
This gives them a constant location above the earth or within a few degreees of longitude.
Such systems are the Japanese QZSS and the Indian IRNSS.
The Chinese BeiDou system is a combination of global and regional.
It started with just geostationary and geosynchronous satellites over China, but now has three operational global satellites with more to come.


\section{GPS}

This section closer explains the system architecture, functional principle and performance of GPS.
The difference to the ohter GNSS is minor.
Orbits, frequencys and signal modulation are slightly different between the systems, but the basic architecture is the same.


\section{System Architecture}

The GPS system can be split into three segments.
The Space Segment includes the satellites, the Control Segment is the ground equipment that manages the satellites and the User Segment are the receivers.

\subsubsection{Space Segment}

A full GPS constellation consists of 24 satellites as shown in figure \ref{fig:constellation}.
Currently, there are 31 GPS satellites in operation.
They are in medium earth orbit at an altitude of about 20'200km with each satellite circling the earth twice a day.
About 8 satellites are visible to a user at a time.
These satellites are constantly beeing replaced by newer ones with new features.
The different generations of satellites are divided into Blocks.
Starting with the first generation of satellites launched from 1978 until 1995 called Block \rom{1}.
Block \rom{2} satellites had a series of incremental improvements and added new signals over the time they were launced from 1989 until 2016.
The separate satellite series of the Block \rom{2} generation were called II, IIA, IIR, IIR-M and IIF.
The first Block \rom{3} launch is scheduled for 2018.
The third generation adds even more signals and trinsmitts at higher power levels.

\begin{figure}[ht]
 \centering
 \includegraphics[height=5cm]{images/constellation.jpg}
 \caption{GPS satellite constellation \cite{GPS_GOV}}
 \label{fig:constellation}
\end{figure}

\subsubsection{Control Segment}

To ensure an accurate positioning service for GPS users, the satellites have to be constantely monitored and maintained.
This is the job of the Control Segment.
It monitors satellite orbits and time to predict satellite ephemerides and clock parameters.
It then updates the satellite navigation data, which is later sent from the satellite to the user.
If neccesary, the Control Segment can order the satellites to performe maneuvers to maintain a correct orbit or to relocate to another orbit.
The Control Segment comprises of a network of ground based stations spread arround the globe.
This network is coordinated by the Master Controll Station in the U.S. state of Colorado.

\subsubsection{User Segment}

Finally, the User Segment is where the satellite signals are picked up and the position of the user is calcuated.
Unlike the other segments, the User Segment is not developed by the U.S. Government, apart from military receivers.
The design of civil GPS receivers is left to market forces.
The size of those receivers droped dramatically during the lifetime of GPS from the size of a backpack, to the size of a single microchip.


\subsection{Functional Principle}

GPS works with the principle of trilateration.
For this method of postitoning, the distance to three known lacations is needed to calculate the own position in three dimensions.
This works with basic vector geometry.
The euclidean distance between two points in three-dimensional space can be calculated with equation \ref{eq:euclidean_dist}.

\begin{equation}
 r^{(k)} = \sqrt{(x^{(k)} - x)^2 + (y^{(k)} - y)^2 + (z^{(k)} - z)^2} = \lvert\lvert \textbf{x}^{(k)} - \textbf{x} \rvert\rvert		\label{eq:euclidean_dist}
\end{equation}

For GPS, the two points are the user position $[x, y, z]$ and the satellite position $[x^{(k)}, y^{(k)}, z^{(k)}]$ and the true distance between them is called $r^{(k)}$.
The satellites are distinguished with the superscript $^{(k)}$ where k stands for the k-th satellite in view.
In theory, with the position and distance of three satellites, a system of equations could be constructed and the three variables of the user position $[x, y, z]$ could be estimated.
But in practice, a gps receiver needs at least four satellites to estimate its position.
This is because a fourth variable needs to be estimated called $\delta t_u$.
This is the difference between GPS time and user time.

\begin{figure}[ht]
 \centering
 \includegraphics[width=0.8\textwidth]{images/Position_Estimation.png}
 \caption{GPS triangulation}
 \label{fig:triangulation}
\end{figure}

GPS uses the propagation time of radio waves to determine the distance between satellite and user.
The measured transmision time is multiplied by the speed of light to get the distance in meters.
This is not the true distance $r^{(k)}$.
Insted, the so called pseudorange $\rho^{(k)}$ is measured, which contains the true range and a set of errors.
The relation is shown in equation \ref{eq:pseudorange}.
The pseudorange contains the clock errors $c[\delta t_u - \delta t^{(k)}]$, the atmospheric errors $I^{(k)} + T^{(k)}$ and the remaining errors $\epsilon^{(k)}$.
What they mean is closer explained in section \ref{sec:error_sources}.

\begin{equation}
 \rho^{(k)} = r^{(k)} + c[\delta t_u - \delta t^{(k)}] + I^{(k)} + T^{(k)} + \epsilon^{(k)}		\label{eq:pseudorange}
\end{equation}

Important here is the user clock error $\delta t_u$.
The reason for this error is the unprecise clock in the receiver.
The satellites have atomic clocks which are synchorinized to GPS time.
It is not feasable to build an atomic clocks into every receiver and keep it synchorinized to GPS time.
Insted, the difference between receiver time and GPS time is estimatet with the measurement from a fourth satellite.
This is possible because the user clock error is common in the pseudoranges from all satellites.
The estimation of the four variables $[x, y, z, \delta t_u]$ is either done iteratively with the Least Square method or with a Kalman filter.

\subsection{Signals}

A GPS receiver can work with only the information included in the signals from the satellites.
This means the information for distance and satellite position have to be transmitted with those signals.
GPS solves this problem with a three-layered signals like the one in figure \ref{fig:signal_structure}.

\begin{figure}[ht]
 \centering
 \includegraphics[width=0.8\textwidth]{images/Signal_Structure.png}
 \caption{C/A-code signal structure (not to scale)}
 \label{fig:signal_structure}
\end{figure}

The carrier is a sinusoidal signal in the L band.
Most civil GPS receivers work with the L1 signal at 1575.42MHz.
GPS satellites also send on L2 at 1227.6 MHz and newer satellites on L5 at 1176.45 MHz too.
A variety of civil and encrypted military signals are modulated onto those carriers.
The main signal for civil applications is the C/A-code on L1.
It consists of the C/A-code itself and a data stream.
The C/A-code and the data stream are both binary sequences.
They are first XORed together and then modulated onto the carrier using \textit{binary phase shift keying} (BPSK).

The C/A-code is a sequence of 1023 bits, which repeats every millisecond and is unique to each satellite.
The lenght of each bit, or chip in this context, is about $1\mu s$.
This code is used to measure the signal transmission time.
The received signal is demodulated and correlated with local copies of the C/A-codes on separate channels.
The local copy is shifted in time until an autocorrelation peak emerges.
This timeshift determines the signal transmission time. 

Besides the C/A-code is the data stream that contains the navigation message.
It has information about the satellite orbit and the satellite clock error.
The obit data is called ephemeris data.
With it, the position of the satellite can be calculates at the desired time.
The satellite clock error information is used to correct the pseudorange for the term $\delta t^{(k)}$.

\subsection{Performance}



\section{Error Sources}\label{sec:error_sources}

\subsection{Satellite Errors}

\subsection{Signal Propagation Errors}

\subsection{Receiver Errors}
